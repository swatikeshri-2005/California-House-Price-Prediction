# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1BuYRwRNqzWPpu1lsIBDrW8SAPa_PbxW9
"""

!pip install scikit-learn gradio pandas

from sklearn.datasets import fetch_california_housing
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.pipeline import make_pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestRegressor

data = fetch_california_housing(as_frame=True)
df = data.frame

X = df.drop(columns=["MedHouseVal"])
y = df["MedHouseVal"]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)


model = make_pipeline(StandardScaler(), RandomForestRegressor())
model.fit(X_train, y_train)

def predict_house_price(med_inc, house_age, ave_rooms, ave_bedrooms, population,
                        ave_occup, latitude, longitude):
    input_data = pd.DataFrame([[ med_inc, house_age, ave_rooms, ave_bedrooms,
                                 population, ave_occup, latitude, longitude]], columns=X.columns)
    prediction = model.predict(input_data)[0]
    return f"Predicted Price: \\${prediction * 100000:.2f}"

import gradio as gr

interface = gr.Interface(
    fn = predict_house_price,
    inputs = [
        gr.Slider(0.0, 20.0, label="Median Income (10k\$ units)"),
        gr.Slider(1, 50, label="House Age"),
        gr.Slider(1, 10, label="Average Rooms"),
        gr.Slider(1, 5, label="Average Bedrooms"),
        gr.Slider(100, 50000, label="Population"),
        gr.Slider(1, 10, label="Average Occupancy"),
        gr.Slider(32, 42, label="Latitude"),
        gr.Slider(-125, -114, label="Longitude"),
    ],
    outputs = "text",
    title = "California House Price Predictor",
    description = "Enter basic housing info to estimate price",
)
interface.launch(share=True)